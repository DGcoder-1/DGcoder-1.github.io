<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Nome do site -->
    <title>Biblioteca de Hyrule</title>
    <!-- √çcone da aba do site -->
    <link rel="icon" type="image/x-icon" href="https://static.thenounproject.com/png/18493-200.png">

    <style>
        /* O :root √© tipo um alicerce e est√° definindo as cores definitivas que ser√£o usadas no site com uso de vari√°veis pro c√≥digo de cor n√£o se repetir direto */
        
        :root {
            --gold: #d4af37;
            --zelda-green: #00703c;
            --dark-glass: rgba(0, 0, 0, 0.75);
        }
        
        /*No body est√° sendo definida a fonte de texto,uma transi√ß√£o limpa das imagens de fundo e est√° centralizando o projeto */
        
        body {
            margin: 0; padding: 0;
            font-family: 'Segoe UI', Roboto, sans-serif;
            background-color: #111;
            background-image: url('https://media.tenor.com/tjL7ZLQIAMcAAAAM/zelda-ocarina-of-time.gif');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            transition: background-image 0.8s ease-in-out;
            color: white;
            display: flex; justify-content: center;
            min-height: 100vh;
        }

        /*O foco ativo aqui serve para poder indicar √°reas clic√°veis */

        .foco-ativo { cursor: pointer; }

        /*Aqui √© onde o css est√° tornando a hub invis√≠vel para quando for ativo o modo foco*/

        .foco-ativo .container, .foco-ativo .btn-export-group {
            opacity: 0;
            pointer-events: none;
            transform: translateY(20px);
        }
        /*Aqui o css est√° definindo a posi√ß√£o,bordas,cor e a apari√ß√£o da caixinha que aparece no modo foco "Vis√£o 1/2" ou "Vis√£o 2/2" */

        #gallery-info {
            position: fixed; top: 20px; left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.7);
            padding: 10px 25px; border-radius: 30px;
            border: 1px solid var(--gold);
            font-size: 0.9rem; opacity: 0;
            transition: 0.5s; z-index: 10000;
            color: var(--gold); letter-spacing: 1px;
        }

        /*Isto aqui torna eles v√≠siveis no modo foco */
        .foco-ativo #gallery-info { opacity: 1; }

        /* Aqui est√° sendo definindo todo o estilo apar√™ncia e posi√ß√£o da div class=container */
        .container {
            background: var(--dark-glass);
            backdrop-filter: blur(15px);
            padding: 40px; width: 90%; max-width: 1100px;
            margin: 40px 20px; border-radius: 20px;
            border: 1px solid var(--gold);
            box-shadow: 0 0 50px rgba(0,0,0,0.9);
            text-align: center;
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /*Nesse Header est√° sendo mudada a cor,tamanho da fonte e deixando tudo em mai√∫sculo */

        header h1 {
            font-size: 2.8rem; color: var(--gold);
            text-transform: uppercase; letter-spacing: 4px;
            text-shadow: 0 0 15px rgba(212, 175, 55, 0.6);
            margin-bottom: 5px;
        }

        /*Muda a cor,tamanho da fonte e dimensiona melhor o texto do contador */
        
        .contador-lendas {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 20px;
            letter-spacing: 1px;
        }

         /*Coloca uma cor de fundo, espacionamento e deixa flex√≠vel a div do sistema de registro */

        .registro-box {
            background: rgba(255, 255, 255, 0.05);
            padding: 25px; border-radius: 15px;
            margin: 30px 0; display: flex;
            flex-direction: column; gap: 15px;
        }

         /*Deixa flex√≠vel,mais bonita e dimensiona a div do dia de inicio*/
         
        .datas-container { display: flex; flex-wrap: wrap; gap: 15px; width: 100%; }

         /*Deixa flex√≠vel,mais bonita e dimensiona a div do dia de vit√≥ria*/

        .data-item { flex: 1; min-width: 200px; }

        /*Estiliza as palavras "Dia de in√≠cio" e  "Dia da vit√≥ria" para ficarem no padr√£o das demais letras, mudando a cor, tamanho, etc*/

        .label-data { text-align: left; font-size: 0.85rem; color: var(--gold); margin-bottom: 5px; font-weight: bold; }

        /*Deixa as barras de escrever do registro mais bonitas, pretas e bem dimensionadas*/
        input {
            background: rgba(0,0,0,0.7);
            border: 1px solid #444; padding: 12px;
            color: white; border-radius: 8px;
            outline: none; width: 100%; box-sizing: border-box;
        }
        
        /*Altera a cor comum do texto em foco pra dourada*/

        input:focus { border-color: var(--gold); }
        
        /*Deixa o bot√£o de salvar,mais bonito,coeso o dimensionando*/

        .btn-main {
            background: var(--zelda-green);
            color: white; border: none; padding: 18px;
            border-radius: 8px; font-weight: bold; cursor: pointer;
            font-size: 1.1rem; transition: 0.3s; margin-top: 10px;
        }

        /*Deixa o bot√£o mais gordo quando passa o mouse em cima*/
        
        .btn-main:hover { background: #00a85a; transform: scale(1.02); }

        /*Centraliza e dimensiona os bot√µes de exportar e importar*/

        .btn-export-group {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
        }

        /*Define o fundo e borda colorida para os bot√µes de exportar e importar*/

        .btn-secundary {
            background: none; color: var(--gold);
            border: 1px solid var(--gold);
            padding: 8px 15px; border-radius: 5px;
            cursor: pointer; font-size: 0.8rem;
        }

        /*Define posi√ß√£o, formato, dimensiona e colore o bot√£o que acessa o modo foco*/

        .btn-view-bg {
            position: fixed; bottom: 30px; right: 30px;
            background: var(--gold); color: black;
            border: none; width: 60px; height: 60px;
            border-radius: 50%; font-size: 1.8rem;
            cursor: pointer; box-shadow: 0 5px 20px rgba(0,0,0,0.5);
            z-index: 9999; display: flex; align-items: center; justify-content: center;
        }

        /*Os ficam menores e parecem com cartas */

        #listaJogos {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px; margin-top: 40px;
        }

        /* Dimensiona as cartas para ter um tamanho praticamente fixo independente do tamanho da imagem colocada  */

        .card-img-container { width: 100%; height: 380px; background: #222; }

        /*Dimensiona as imagens dos jogos para ele n√£o estourar e tampar boa parte da tela */

        .card-jogo img { width: 100%; height: 100%; object-fit: cover; }

        /*Ele deixa as cartas com uma apar√™ncia mais ret√¢ngular */

        .card-content { padding: 20px; text-align: left; }

        /*Deixa o nome dos jogos das cartas na cor dourada e muda umpouco a fonte de tamanho */

        .card-content h3 { color: var(--gold); margin: 0 0 12px 0; font-size: 1.2rem; }

        /*Detalha mais a √°rea de editar e excluir dos jogos */

        .card-actions { padding: 15px; display: flex; gap: 10px; background: rgba(255,255,255,0.03); }

        /*Dimensiona, coloca fundo e cor no bot√£o de editar */

        .btn-edit { background: #444; flex: 1; padding: 10px; border: none; color: white; cursor: pointer; border-radius: 5px; }

         /*Dimensiona, coloca fundo e cor no bot√£o de excluir */

        .btn-del { background: #8b0000; flex: 1; padding: 10px; border: none; color: white; cursor: pointer; border-radius: 5px; }

    </style>
</head>
 <!-- Aqui √© onde √© definido o id do body pra o programa poder puxar futuramente e esse onclick do js est√° aqui pra quando eu quiser ver mais de uma imagem pro plano de fundo, √© s√≥ eu entrar no modo foco e com um clique eu troco a foto -->
<body id="bodyHyrule" onclick="proximaFotoGaleria()">
<!-- Essa div de id gallery-info √© uma informa√ß√£o que aparece no modo foco apenas se o usu√°rio nunca registrou nenhum jogo -->
    <div id="gallery-info">‚ú® Se voc√™ leu isso, voc√™ √© lindo e por favor registre suas mem√≥rias nos livros</div>
    <!-- Esse √© um bot√£o que ao clickar ativa o "modo foco" que deixa o usu√°rio comtemplar o fundo sem a hud no meio -->
    <button class="btn-view-bg" onclick="toggleModoFoco(event)" title="Contemplar fundo">üëÅÔ∏è</button>
    <!-- Esse √© o container principal que tem uma grande l√≥gia visual no site e quando o modo foco √© ativado esse container fica escondido -->
    <div class="container">
        <header>
            <!-- T√≠tulo do site -->
            <h1>Biblioteca de Hyrule</h1>
            <!-- Texto que serve de contador de jogos de quantos jogos foram registrados que ser√° alterado com js -->
            <div id="contadorLendas" class="contador-lendas">0 lendas registradas nos Livros de Hist√≥ria</div>
        </header>

        <section>
            <!-- Aqui √© a div que pede todas as informa√ß√µes para se registrar e a √∫nica obrigat√≥ria √© o nome completo do jogo,
                 mas pode ser colocado, data que come√ßou a jogar quando terminou, etc  -->
            <div class="registro-box">
                <input type="hidden" id="editIndex">
                <input type="text" id="nome" placeholder="T√≠tulo Completo" required>

                <div class="datas-container">
                    <div class="data-item">
                        <div class="label-data">Data de In√≠cio:</div>
                        <input type="date" id="dataInicio">
                    </div>
                    <div class="data-item">
                        <div class="label-data">Data da Vit√≥ria:</div>
                        <input type="date" id="dataZerou">
                    </div>
                </div>

                <div class="datas-container">
                    <div class="data-item">
                        <input type="number" id="dungeons" placeholder="Dungeons Completas">
                    </div>
                    <div class="data-item">
                        <input type="text" id="plataforma" placeholder="Console (Ex: NES, SNES, Switch)">
                    </div>
                </div>
               <!--  Esse bot√£o √© potente, ele quando for clickado ativa uma fun√ß√£o de js que vai pegar as informa√ß√µes coletadas e salvar elas na p√°gina na mem√≥ria local-->   
                <button onclick="salvarJogo()" id="btnSalvar" class="btn-main"> ‚öîÔ∏è Tome seu Lugar Entre as Lendas </button>
            </div>
               <!-- Aqui temos uma pequena div pros bot√µes que exportam e salvam os dados -->
            <div class="btn-export-group">
                <!-- Esse bot√£o √© s√≥ clickar nele que ele ativa uma fun√ß√£o em js que pode trazer arquivos j√° registrados de outros locais e sobreescrever os dados/jogos que j√° tem na sua p√°gina -->
                <button class="btn-secundary" onclick="exportarCSV()">üìú Exportar CSV</button>
                <!--Esse bot√£o quando for clickado vai ativar uma fun√ß√£o de js que vai pegar o arquivo selececionado e sobrescrever na sua p√°gina  -->
                <button class="btn-secundary" onclick="document.getElementById('inputCSV').click()">üìÇ Importar CSV</button>
                <!-- Esse input aqui t√° pra ajudar o bot√£o de cima a realizar sua fun√ß√£o, mas est√° escondido para deixar o site mais bonito -->
                <input type="file" id="inputCSV" accept=".csv" style="display:none" onchange="importarCSV(event)">
            </div>
        </section>
       
        <div id="listaJogos"></div>
    </div>

    <script>
         /*Essa constante √© onde o programa t√° guardando v√°rias fotos e imagens dos seus respectivos jogos pra usar no card e no fundo da p√°gina*/

        const databaseZelda = {
            "the legend of zelda: echoes of wisdom": { 
                capa: "https://m.media-amazon.com/images/I/71vCMnjgF7L._AC_UF1000,1000_QL80_.jpg",
                galeria: ["https://uploads.jovemnerd.com.br/wp-content/uploads/2024/09/zelda_echoes_of_wisdom_linha_temporal__l00v1o6.jpg",
                 "https://i.ytimg.com/vi/9wT30wTW06o/maxresdefault.jpg"]
            },
            "the legend of zelda: tears of the kingdom": {
                capa: "https://cdn.awsli.com.br/2500x2500/2443/2443989/produto/2167923545f26e10d1f.jpg",
                galeria: ["https://sm.ign.com/t/ign_ap/news/p/psa-the-le/psa-the-legend-of-zelda-tears-of-the-kingdom-art-book-has-se_vrr6.1200.jpg", 
                "https://i.redd.it/b2ckbkurr62f1.gif"]
            },
            "the legend of zelda: breath of the wild": {
                capa: "https://m.media-amazon.com/images/I/71jhb25cR0L._AC_UF1000,1000_QL80_.jpg",
                galeria: ["https://external-preview.redd.it/LJ0tlQdStNyLMqSil6_03RNt8iuvrQY7rtw_6vyVax0.jpg?width=640&crop=smart&auto=webp&s=e95ae4224255d3ff46a1e67245953ff293fe76a9",
                 "https://media.tenor.com/V3GZakZumXIAAAAM/zelda-cucco.gif"]
            },
            "the legend of zelda: a link between worlds": {
                capa: "https://cdn.ome.lt/legacy/images/galerias/The-Legend-of-Zelda-A-Link-Between-Worlds/The-Legend-of-Zelda-A-Link-Between-Worlds-28-ago-2013-1.jpg",
                galeria: ["https://www.zeldauniverse.net/wp-content/uploads/2013/10/A-Link-Between-Worlds-Full-Size-Artwork.png", 
                "https://i.imgflip.com/68nc5w.jpg"]
            },
            "the legend of zelda: skyward sword": {
                capa: "https://m.media-amazon.com/images/I/81eFyVKONOL._AC_UF1000,1000_QL80_.jpg",
                galeria: ["https://www.nintendo.com/eu/media/images/10_share_images/games_15/wii_24/SI_Wii_TheLegendOfZeldaSkywardSword_image1600w.jpg", 
                "https://preview.redd.it/all-hey-its-that-zelda-guy-v0-rpbq7hia2m0b1.jpg?width=640&crop=smart&auto=webp&s=da420199eadbb74a8d98a2ac3014109eed4bb58a"]
            },
            "the legend of zelda: spirit tracks": {
                capa: "https://cdn.awsli.com.br/600x450/1385/1385452/produto/385471848/d_nq_np_723581-mla99379806032_112025-o-hge8ls71xa.webp",
                galeria: ["https://cdn.displate.com/artwork/1200x857/2020-02-07/2887ce4e87f9e0d0c448d12806d72085_7f1e3ea8d77122f0d52146bff918ecf1.jpg", 
                "https://i.pinimg.com/736x/58/5e/13/585e1381ff5763dfd5ababe67bc2dcdc.jpg"]
            },
            "the legend of zelda: phantom hourglass": {
                capa: "https://upload.wikimedia.org/wikipedia/pt/archive/8/81/20171115000406%21The_Legend_of_Zelda_Phantom_Hourglass_capa.png",
                galeria: ["https://i.pinimg.com/736x/01/37/eb/0137eb1f719d6d97ef57fc3ce95b26e9.jpg",
                 "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhKUD9KzKl4qhED7aQxhXbNO841A8_LxuNQGiOZMQ6qps6DWRvVsmgI5MPFqS5qYiFdXj9i3tD1omLYMHdTqVapVkKqEkx2tDoMLeaZsXsQV0XrDyISib76iHeY9z5v5eOcesh0dLkP6Uw/s1600/giphy.gif"]
            },
            "the legend of zelda: twilight princess": {
                capa: "https://m.media-amazon.com/images/I/811Zo-8yksL.jpg",
                galeria: ["https://assets1.ignimgs.com/2012/10/19/twilightprincessheaderjpg-081378.jpg",
                 "https://preview.redd.it/baby-im-preying-on-you-tonight-v0-1nbut93vzt2e1.png?width=720&format=png&auto=webp&s=d3f5e2311f98c7a7bcfd31ac0d5ed1186dac5c60"]
            },
            "the legend of zelda: the minish cap": {
                capa: "https://upload.wikimedia.org/wikipedia/pt/2/21/The_Legend_of_Zelda_The_Minish_Cap_capa.png",
                galeria: ["https://i.redd.it/mc-the-minish-cap-has-to-have-some-of-my-favorite-toon-v0-gfvyxq58qdae1.png?width=1800&format=png&auto=webp&s=d5ad8665387525ad06aa1f752faf30cd8b85522b",
                 "https://i.redd.it/c7s0mqv9b1051.png"]
            },
            "the legend of zelda: wind waker": {
                capa: "https://m.media-amazon.com/images/I/51p83TJUAYL._AC_UF1000,1000_QL80_.jpg",
                galeria: ["https://i.redd.it/kj5hlou680xe1.jpeg",
                 "https://i.redd.it/o671eudspvob1.jpeg"]
            },
            "the legend of zelda: majora's mask": {
                capa: "https://upload.wikimedia.org/wikipedia/pt/3/35/The_Legend_of_Zelda_Majora%27s_Mask_capa.png",
                galeria: ["https://external-preview.redd.it/mm-majoras-mask-art-director-wanted-to-work-on-one-last-v0-fnes5ntCClus7eST8-RRf2emrQl55whDWt6bMo3PyKM.jpg?width=640&crop=smart&auto=webp&s=0eaf321e772c62d5eaff46caef9164ded1abf9d0",
                 "https://external-preview.redd.it/-jM6t9c17FeN6g6mIvU6ofAW6GfP0hJEvJ1RKLuwT3Q.png?auto=webp&s=76ec2d20e9b9587c4008c444ad580924402e1abc"]
            },
            "the legend of zelda: ocarina of time": {
                capa: "https://s2-techtudo.glbimg.com/Gl0uFZq30gR-iY3zuij0Hxaeg9o=/0x0:695x476/984x0/smart/filters:strip_icc()/i.s3.glbimg.com/v1/AUTH_08fbf48bc0524877943fe86e43087e7a/internal_photos/bs/2021/f/Y/wnMJWOQAe0EikqH0oCQg/2013-11-22-zelda01.jpg",
                galeria: [ "https://pbs.twimg.com/media/G-Ejo2pbAAA3Lku.jpg",
                 "https://i.redd.it/82nrq9dii93f1.gif"]
            },
            "the legend of zelda: oracle of ages": {
                capa: "https://upload.wikimedia.org/wikipedia/pt/a/a6/The_Legend_of_Zelda_Oracle_of_Ages_capa_europa_Game_Boy_Color.png",
                galeria: ["https://www.rpgfan.com/wp-content/uploads/2020/12/The-Legend-of-Zelda-Oracle-of-Ages-Artwork-004.webp",
                 "https://media.tenor.com/YniopqJYMIkAAAAe/gato-rindo.png"]
            },
            "the legend of zelda: oracle of seasons": {
                capa: "https://upload.wikimedia.org/wikipedia/pt/f/fe/The_Legend_of_Zelda_Oracle_of_Seasons_capa_europa_Game_Boy_Color.png",
                galeria: ["https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ7cjYDfmmgQuzLhIMJONTV-3XR4k3K1BFZsw&s", 
                "https://nintendoreviewsblog.wordpress.com/wp-content/uploads/2013/06/tloz_oracle_of_seasons_presentation.jpg?w=584"]
            },
            "the legend of zelda: link's awakening": { 
                capa: "https://upload.wikimedia.org/wikipedia/pt/f/f8/The_Legend_of_Zelda_Link%27s_Awakening_capa.png",
                galeria: ["https://i.etsystatic.com/10064703/r/il/2a87e5/4983455899/il_570xN.4983455899_pmsp.jpg", 
                "https://preview.redd.it/this-meme-is-true-v0-c9v1fhwtmqdg1.jpeg?auto=webp&s=8bf85fcf8036c30fc5c339aa5b37f8d4a92ac28d"]
            },
            "the legend of zelda: a link to the past": { 
                capa: "https://upload.wikimedia.org/wikipedia/pt/3/31/The_Legenda_of_Zelda_A_Link_to_the_Past_capa.png",
                galeria: ["https://mediaproxy.tvtropes.org/width/1200/https://static.tvtropes.org/pmwiki/pub/images/alttp_link_looking_at_the_tower_of_hera_artwork.png", 
                "https://i.makeagif.com/media/5-26-2017/RUzW55.gif"]
            },
            "the legend of zelda ii: the adventure of link": { 
                capa: "https://greenhillszone.com/wp-content/uploads/2013/01/563487_29057_front.jpg",
                galeria: ["https://external-preview.redd.it/zelda-2-was-nintendo-at-its-best-unpredictable-v0-p_lQE8qCivcCjvUstY6svoZHkLTU4QdFG-b_h5Aznsw.jpg?auto=webp&s=2f2abc5444fde443f3c1273ea6bfa9f7a87fc3c3", 
                "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRuD4y-4t3zgTpmMr69zZcmvfxrqADTUM3H0A&s"]
            },
            "the legend of zelda": { 
                capa: "https://upload.wikimedia.org/wikipedia/pt/9/96/The_Legend_of_Zelda_1_capa.png",
                galeria: ["https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj4YbJ8OQjMvVZ0TO5EQEmuy8E9L_VYoQIqDTdQrRcFUVDSxiZ05CZBtoqwZ65yPBaPVCyRh_Yd7YxQuuC_QgWrSXIIjeTNHDED_HIRALo9U0KvcrXEqQXbrj_aTTY5KLsFtEcsIkxw4tCE/s1600/Zelda_NES_Nintendo.jpg", 
                "https://media3.giphy.com/media/v1.Y2lkPTZjMDliOTUyZ244OXJyMXFxOHh2ZHBtcGE4dmptMWtkM3U2ejJtOXRwNXQ1cGZ3bSZlcD12MV9naWZzX3NlYXJjaCZjdD1n/kuGxJyTQQAUw0/giphy.gif"]
            }
        };
        
        /*Esse let faz um sistema onde o getItem vai atr√°s das informa√ß√µes dentro do localStorage,
         depois o JSON.parse traduz pra poder manipular de string pra array e caso n√£o achem nada v√£o criar uma lista 0km
         e eu defini uma vari√°vel jogos para simplificar quando for usar novamente */

        let jogos = JSON.parse(localStorage.getItem('bibliotecaHyrule')) || [];

        /*Esse let vai ser para saber qual foto de fundo est√° a p√°gina*/
        
        let fotoAtualIndex = 0;

        /*Essa function faz o modo foco e configura o bot√£o dele, o function chama o body e usando if faz o seguinte,
          se o foco ativo estiver o bot√£o √© mudado pra ficar com o s√≠mbolo de X troca a cor dele pra vermelho,
          com o clique agora √© posssivel trocar a imagem,
          j√° se n√£o estiver l√° o bot√£o vai ficar o com o olhinho e vai ficar com o fundo do bot√£o cor de ouro 
          e por fim a hud de registrar jogos aparece novamente */

        function toggleModoFoco(event) {
            if(event) event.stopPropagation();
            const body = document.getElementById('bodyHyrule');
            const btn = document.querySelector('.btn-view-bg');
            body.classList.toggle('foco-ativo');
            if (body.classList.contains('foco-ativo')) {
                btn.innerText = "‚ùå"; btn.style.background = "#8b0000"; btn.style.color = "white";
                fotoAtualIndex = 0; atualizarBackgroundFoco();
            } else {
                btn.innerText = "üëÅÔ∏è"; btn.style.background = "var(--gold)"; btn.style.color = "black";
                renderizarJogos();
            }
        }
       
        /*Essa function faz um if se n√£o estiver no modo foco ou n√£o tiver nenhum jogo registrado,
         ent√£o a variavel fotoAtuaalIndex √© ativada e o aciona a fun√ß√£o atualizarBackgroundFoco */

        function proximaFotoGaleria() {
            if (!document.body.classList.contains('foco-ativo') || jogos.length === 0) return;
            fotoAtualIndex++; atualizarBackgroundFoco();
        }
        
        /*Essa function faz com que um if se n√£o tiver nenhum jogo registrado diminua o array jogos por um depois chama a function BuscarInfoJogo,
        que checa as informa√ß√µes dos jogos e d√° um retorno depois ele busca as imagens na galeria,
         depois pega o resto da divis√£o do valor da FotoAtualIndex que troca de acordo com o clique e do valor da quantidade de fotos da galeria,
         linka o resultado pra aparecer na tela e no fim concatena pra dizer se √© a Vis√£o 1 ou Vis√£o 2 do background  */
 

        function atualizarBackgroundFoco() {
            if (jogos.length === 0) return;
            const ultimoJogo = jogos[jogos.length - 1];
            const info = buscarInfoJogo(ultimoJogo.nome);
            const galeria = info.galeria;
            const indexReal = fotoAtualIndex % galeria.length;
            document.body.style.backgroundImage = `url('${galeria[indexReal]}')`;
            document.getElementById('gallery-info').innerText = `Vis√£o ${indexReal + 1} de ${galeria.length}`;
        }

        /*Essa function buscarInfoJogo √© respons√°vel por interpretar o nome do jogo e traduzir pro programa pra letras min√∫sculas e o trim remove espa√ßos in√∫teis do reconhecimento,
        object.keys est√° buscando o nome dos meus jogos e o sort(a, b) t√° ordenando eles do maior pro menor na hora de reconhecer
         e isso evita erros de por exemplo o usu√°rio escrever o nome de um jogo e acabar dando em outro com um come√ßo de nome parecido,
          no for o sistema checa cada um dos nomes dos jogos e quando ele encontra o que o usu√°rio escreveu a const databaseZelda devolve as imagens de fundo e capas dos jogos  e caso n√£o encontre o nome manda outras imagens */

        function buscarInfoJogo(nome) {
            const nomeFiltro = nome.toLowerCase().trim();
            const chaves = Object.keys(databaseZelda).sort((a, b) => b.length - a.length);
            for (let chave of chaves) {
                if (nomeFiltro.includes(chave)) return databaseZelda[chave];
            }
            return {
                capa: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSa4C1a1U48Qg3LIk6bFdXTwOCgBavK4GA6aw&s",
                galeria: ["https://media4.giphy.com/media/v1.Y2lkPTZjMDliOTUyczF3MWxycnd0NWFmeHIxdGl0N2xlNTYyZzh0Z3lmOTkxOGdzbmJuMCZlcD12MV9naWZzX3NlYXJjaCZjdD1n/jgVXeRc0Jvv4QFghcz/giphy.gif"]
            };
        }

         /*Essa function formatarData age da seguinte maneira, se n√£o tiver nada no campo de data quando salvar o data vai ser 3 tracinhos 
         e depois ele define o primeiro tra√ßo como dia,o segundo como m√™s e o √∫ltimo o ano e ai √© poss√≠vel separar um por um espa√ßadosnpor barras tipo 15/04/2010  */

        function formatarData(data) {
            if (!data) return "---";
            const [ano, mes, dia] = data.split('-');
            return `${dia}/${mes}/${ano}`;
        }
 
        /*Essa function atualizarContador busca o contador de jogos, atribui uma constante ao n√∫mero de jogos dentro do array "jogos" 
        e por √∫ltimo concatena usando o n√∫mero de jogos e colocand na frente da mensagem de quantos jogos registrados tem na p√°gina*/

        function atualizarContador() {
            const el = document.getElementById('contadorLendas');
            const n = jogos.length;
            el.innerText = `${n} ${n === 1 ? 'lenda registrada' : 'lendas registradas'} nos Livros de Hist√≥ria`;
        }
       
        /*Essa function renderizar jogos primeiramente chama o atualizador de contador pra ele se alterar quando os jogos forem importados,
        chama o container com os cards dos jogos e a lista.innerHTML zera os dados que haviam na p√°gina anteriormente,
        se tiver 1 ou mais jogos na lista de jogos desconta -1 do array pra conta dar certo 
        e usa o buscarInfoJogo para descobrir qual √© o √∫ltimo jogo registrado pra deixar as imagens dele na p√°gina 
        e define a primeria foto da galeria do √∫ltimo jogo registrado pra ele aparecer no fundo da p√°gina, 
        mas se n√£o houver nenhum jogo registrado ele vai mandar outra imagem como a de fundo a "padr√£o do site",
        depois a fun√ß√£o ca√ßa o nome dos jogos e vai colocando mais cartas dos jogos e "empilhando" elas,
        depois cria toda a estrutura dos cards com divs e textos e se n√£o tem nada escrito aparece N\A e estrutura o editar e o delete pra n√£o colidir com o modo foco
        e chama as fun√ß√µes de editar e apagar */

        function renderizarJogos() {
            atualizarContador();
            const lista = document.getElementById('listaJogos');
            lista.innerHTML = '';
            if (jogos.length > 0) {
                const ultimoJogo = jogos[jogos.length - 1];
                const info = buscarInfoJogo(ultimoJogo.nome);
                document.body.style.backgroundImage = `url('${info.galeria[0]}')`;
            } else {
                document.body.style.backgroundImage = `url('https://media.tenor.com/tjL7ZLQIAMcAAAAM/zelda-ocarina-of-time.gif')`;
            }
            jogos.forEach((jogo, index) => {
                const info = buscarInfoJogo(jogo.nome);
                lista.innerHTML += `
                    <div class="card-jogo">
                        <div class="card-img-container"><img src="${info.capa}"></div>
                        <div class="card-content">
                            <h3>${jogo.nome}</h3>
                            <p>üéÆ <strong>Console:</strong> ${jogo.plataforma || 'N/A'}</p>
                            <p>üìÖ <strong>In√≠cio:</strong> ${formatarData(jogo.dataInicio)}</p>
                            <p>üèÜ <strong>Zerado:</strong> ${formatarData(jogo.dataZerou)}</p>
                            <p>üè∞ <strong>Dungeons:</strong> ${jogo.dungeons || '0'}</p>
                        </div>
                        <div class="card-actions">
                            <button class="btn-edit" onclick="event.stopPropagation(); prepararEdicao(${index})">Editar</button>
                            <button class="btn-del" onclick="event.stopPropagation(); deletarJogo(${index})">Apagar</button>
                        </div>
                    </div>`;
            });
        }

        function salvarJogo() {
            const nomeInput = document.getElementById('nome').value;
            if (!nomeInput) return alert("D√™ um t√≠tulo √† sua lenda!");
            const jogo = {
                nome: nomeInput,
                dataInicio: document.getElementById('dataInicio').value,
                dataZerou: document.getElementById('dataZerou').value,
                dungeons: document.getElementById('dungeons').value,
                plataforma: document.getElementById('plataforma').value
            };
            const editIndex = document.getElementById('editIndex').value;
            if (editIndex === "") {
                jogos.push(jogo);
            } else {
                jogos[editIndex] = jogo;
                document.getElementById('editIndex').value = "";
                document.getElementById('btnSalvar').innerText = " Tome seu Lugar Entre as Lendas ‚öîÔ∏è ";
            }
            localStorage.setItem('bibliotecaHyrule', JSON.stringify(jogos));
            limparCampos(); renderizarJogos();
        }

        function deletarJogo(index) {
            if (confirm("Apagar este registro?")) {
                jogos.splice(index, 1);
                localStorage.setItem('bibliotecaHyrule', JSON.stringify(jogos));
                renderizarJogos();
            }
        }

        function prepararEdicao(index) {
            const jogo = jogos[index];
            document.getElementById('nome').value = jogo.nome;
            document.getElementById('dataInicio').value = jogo.dataInicio;
            document.getElementById('dataZerou').value = jogo.dataZerou;
            document.getElementById('dungeons').value = jogo.dungeons;
            document.getElementById('plataforma').value = jogo.plataforma;
            document.getElementById('editIndex').value = index;
            document.getElementById('btnSalvar').innerText = "üîÑ Atualizar Registro";
            window.scrollTo({top: 0, behavior: 'smooth'});
        }

        function limparCampos() {
            document.querySelectorAll('input:not([type="hidden"])').forEach(i => i.value = '');
        }

        function exportarCSV() {
            if (jogos.length === 0) return alert("N√£o h√° registros para exportar!");
            let csvContent = "nome,dataInicio,dataZerou,dungeons,plataforma\n";
            jogos.forEach(j => {
                let linha = `"${j.nome}","${j.dataInicio}","${j.dataZerou}","${j.dungeons}","${j.plataforma}"\n`;
                csvContent += linha;
            });
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement("a");
            const url = URL.createObjectURL(blob);
            link.setAttribute("href", url);
            link.setAttribute("download", "biblioteca_hyrule.csv");
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function importarCSV(event) {
            const file = event.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = function(e) {
                const text = e.target.result;
                const linhas = text.split('\n');
                const novosJogos = [];
                for (let i = 1; i < linhas.length; i++) {
                    if (linhas[i].trim() === "") continue;
                    const colunas = linhas[i].split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
                    if (colunas.length >= 5) {
                        novosJogos.push({
                            nome: colunas[0].replace(/"/g, '').trim(),
                            dataInicio: colunas[1].replace(/"/g, '').trim(),
                            dataZerou: colunas[2].replace(/"/g, '').trim(),
                            dungeons: colunas[3].replace(/"/g, '').trim(),
                            plataforma: colunas[4].replace(/"/g, '').trim()
                        });
                    }
                }
                if (confirm(`Deseja importar ${novosJogos.length} jogos? Isso substituir√° sua lista atual.`)) {
                    jogos = novosJogos;
                    localStorage.setItem('bibliotecaHyrule', JSON.stringify(jogos));
                    renderizarJogos();
                }
            };
            reader.readAsText(file);
            event.target.value = '';
        }

        renderizarJogos();
    </script>
</body>
</html>
